"use strict";(self["webpackChunkpet"]=self["webpackChunkpet"]||[]).push([[179],{2179:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"reset-password-box"},[t("div",{staticClass:"reset-password-title"},[t("h2",{staticClass:"title-text"},[e._v("找回密码")])]),t("el-form",{ref:"resetForm",attrs:{model:e.resetForm,rules:e.rules}},[t("el-form-item",{attrs:{prop:"email"}},[t("el-input",{attrs:{placeholder:"邮箱"},model:{value:e.resetForm.email,callback:function(t){e.$set(e.resetForm,"email",t)},expression:"resetForm.email"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"el-icon-message"})])],2)],1),t("el-form-item",{attrs:{prop:"code"}},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("el-input",{staticStyle:{"flex-grow":"1","margin-right":"10px"},attrs:{placeholder:"请输入邮箱验证码",clearable:""},model:{value:e.resetForm.code,callback:function(t){e.$set(e.resetForm,"code",t)},expression:"resetForm.code"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"el-icon-chat-line-round"})])],2),t("el-button",{staticStyle:{height:"38px","background-color":"blue",border:"blue"},attrs:{type:"primary",size:"small",disabled:e.disabled},on:{click:e.sendVerificationCode}},[e._v(" "+e._s(e.buttonContent)+" ")])],1)]),t("el-form-item",{attrs:{prop:"newPassword"}},[t("el-input",{attrs:{type:"password",placeholder:"设置新密码"},model:{value:e.resetForm.newPassword,callback:function(t){e.$set(e.resetForm,"newPassword",t)},expression:"resetForm.newPassword"}},[t("template",{slot:"prepend"},[t("i",{staticClass:"el-icon-lock"})])],2)],1),t("el-form-item",[t("el-button",{staticStyle:{width:"100%","background-color":"blue",border:"blue"},attrs:{type:"primary"},on:{click:e.onResetPassword}},[e._v("提交")])],1),t("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[t("div",{staticStyle:{cursor:"pointer",color:"#0f9876"},on:{click:e.back}},[e._v("返回")])])],1)],1)},o=[],a=(s(4114),s(7120)),i={name:"ResetPassword",data(){return{countdown:0,disabled:!1,timer:null,emailCode:"",buttonContent:"发送验证码",resetForm:{email:"",code:"",newPassword:""},rules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]}}},methods:{back(){this.$router.push("/login")},sendVerificationCode(){this.disabled||(a.A.get("/email/findByEmail",{params:{email:this.resetForm.email}}).then((e=>{"0"==e.code?(this.$message({type:"success",message:"验证码已发送到您的邮箱,请查收"}),this.emailCode=e.data):this.$message({type:"error",message:e.msg})})),this.countdown=60,this.disabled=!0,this.buttonContent=`${this.countdown}秒后可重发`,this.timer=setInterval((()=>{this.countdown>0?(this.countdown--,this.buttonContent=`${this.countdown}秒后可重发`):(clearInterval(this.timer),this.countdown=0,this.disabled=!1,this.buttonContent="发送验证码")}),1e3))},onResetPassword(){this.$refs.resetForm.validate((e=>{if(!e)return console.error("重置密码失败: 表单校验失败"),!1;this.resetForm.code==this.emailCode?a.A.get("/user/forget",{params:{email:this.resetForm.email,newPassword:this.resetForm.newPassword}}).then((e=>{"0"==e.code?(this.$message({type:"success",message:"密码重置成功"}),this.$router.push("/login")):this.$message({type:"error",message:e.msg})})):this.$message({type:"error",message:"验证码不正确"})}))}},beforeDestroy(){clearInterval(this.timer)}},l=i,n=s(1656),c=(0,n.A)(l,r,o,!1,null,"06f70cca",null),d=c.exports}}]);
//# sourceMappingURL=179.9ef1ea43.js.map