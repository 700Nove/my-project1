"use strict";(self["webpackChunkpet"]=self["webpackChunkpet"]||[]).push([[883],{1883:function(t,e,i){i.r(e),i.d(e,{default:function(){return h}});var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"notice-wrapper"},[e("el-card",{attrs:{shadow:"always"}},[e("div",{staticClass:"control-btns"},[e("el-popconfirm",{attrs:{title:"确认删除?"},on:{confirm:t.batchDelete},scopedSlots:t._u([{key:"reference",fn:function(){return[e("el-button",{staticStyle:{"background-color":"red","border-color":"red"},attrs:{type:"danger",size:"medium"}},[t._v("批量删除")])]},proxy:!0}])}),e("el-button",{staticStyle:{float:"right","background-color":"blue","border-color":"blue"},attrs:{type:"primary",size:"medium"},on:{click:t.handleCreate}},[t._v("发布通知")]),e("el-button",{staticStyle:{float:"right","margin-right":"10px","background-color":"blue","border-color":"blue"},attrs:{type:"primary",size:"medium"},on:{click:function(e){t.exportVisible=!0}}},[t._v("导出数据")])],1),e("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{inline:!0,model:t.listQuery,"label-width":"90px"}},[e("el-form-item",{attrs:{label:"标题"}},[e("el-input",{attrs:{placeholder:"通知标题"},model:{value:t.listQuery.title,callback:function(e){t.$set(t.listQuery,"title",e)},expression:"listQuery.title"}})],1),e("el-form-item",[e("el-button",{staticStyle:{"background-color":"blue","border-color":"blue"},attrs:{type:"primary",size:"medium"},on:{click:t.onSubmit}},[t._v("查询")])],1),e("el-form-item",[e("el-button",{staticStyle:{"background-color":"red","border-color":"red"},attrs:{type:"danger",size:"medium"},on:{click:t.onReset}},[t._v("重置")])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark",size:"medium"},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"60"}}),e("el-table-column",{attrs:{prop:"id",label:"编号",align:"center",width:"120",sortable:""}}),e("el-table-column",{attrs:{prop:"title",label:"标题",align:"center"}}),e("el-table-column",{attrs:{prop:"content",label:"内容",align:"center","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"time",label:"发布时间",align:"center"}}),e("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{size:"mini",disabled:i.row.forbid},on:{click:function(e){return t.handleEdit(i.$index,i.row)}}},[t._v("编辑")]),e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.handleDelete(i.$index,i.row)}}},[t._v("删除")])]}}])})],1),e("Pagination",{attrs:{total:t.total,page:t.listQuery.currentPage,limit:t.listQuery.pageSize},on:{"update:page":function(e){return t.$set(t.listQuery,"currentPage",e)},"update:limit":function(e){return t.$set(t.listQuery,"pageSize",e)},pagination:t.fetchData}}),e("el-dialog",{staticClass:"dialog-form",attrs:{title:"添加",visible:t.formVisibleAdd,width:"30%",modal:!1},on:{"update:visible":function(e){t.formVisibleAdd=e}}},[e("el-form",{ref:"dialogForm",attrs:{model:t.dialogForm,rules:t.formRules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"标题",prop:"title"}},[e("el-input",{model:{value:t.dialogForm.title,callback:function(e){t.$set(t.dialogForm,"title",e)},expression:"dialogForm.title"}})],1),e("el-form-item",{attrs:{label:"内容",prop:"content"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:5},placeholder:"请输入内容",maxlength:"120","show-word-limit":""},model:{value:t.dialogForm.content,callback:function(e){t.$set(t.dialogForm,"content",e)},expression:"dialogForm.content"}})],1),e("div",{staticClass:"footer-item"},[e("el-button",{on:{click:function(e){t.formVisibleAdd=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",disabled:t.isSubmit},on:{click:function(e){return t.handleAdd("dialogForm")}}},[t._v("确 定")])],1)],1)],1),e("el-dialog",{staticClass:"dialog-form",attrs:{title:"编辑",visible:t.formVisibleEdit,width:"30%"},on:{"update:visible":function(e){t.formVisibleEdit=e}}},[e("el-form",{ref:"dialogForm",attrs:{model:t.dialogForm,rules:t.formRules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"标题",prop:"title"}},[e("el-input",{model:{value:t.dialogForm.title,callback:function(e){t.$set(t.dialogForm,"title",e)},expression:"dialogForm.title"}})],1),e("el-form-item",{attrs:{label:"内容",prop:"content"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:5},placeholder:"请输入内容",maxlength:"120","show-word-limit":""},model:{value:t.dialogForm.content,callback:function(e){t.$set(t.dialogForm,"content",e)},expression:"dialogForm.content"}})],1),e("div",{staticClass:"footer-item"},[e("el-button",{on:{click:function(e){t.formVisibleEdit=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",disabled:t.isSubmit},on:{click:function(e){return t.handleEditSave("dialogForm")}}},[t._v("确 定")])],1)],1)],1),e("el-dialog",{attrs:{title:"导出数据",visible:t.exportVisible,width:"500px"},on:{"update:visible":function(e){t.exportVisible=e}}},[e("div",{staticClass:"export-data",staticStyle:{display:"flex","flex-direction":"row","justify-content":"space-between"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.exportTable("xlsx")}}},[t._v("EXCEL格式")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.exportTable("csv")}}},[t._v("CSV格式")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.exportTable("txt")}}},[t._v("TXT格式")])],1),e("div",{staticClass:"hints"},[t._v("TIP：请选择要导出数据的格式。")])])],1)],1)},o=[],a=i(186),s=i(1184),r=i(1867),n=i(193),c=i(7120),d={name:"NoticeList",components:{Pagination:s.A,Upload:r.A,Hints:n.A},data(){return{listLoading:!0,listQuery:{title:void 0,currentPage:1,pageSize:10},dialogForm:{title:void 0,content:void 0},total:0,tableData:[],multipleSelection:[],formVisible:!1,formVisibleAdd:!1,formVisibleEdit:!1,formRules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},isSubmit:!1,filesFormat:".txt, .csv, .xls, .xlsx",exportVisible:!1}},created(){this.fetchData()},methods:{handleSelectionChange(t){this.multipleSelection=t.map((t=>t.id))},handleCreate(){this.formVisibleAdd=!0,this.dialogForm={}},handleEdit(t,e){this.dialogForm=JSON.parse(JSON.stringify(e)),this.formVisibleEdit=!0},handleDelete(t,e){this.$confirm("此操作将删除选中数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{c.A.delete("/notice/"+e.id).then((t=>{0==t.code?(this.$message({type:"success",message:"删除成功!"}),this.onReset()):this.$message({type:"success",errpr:"删除失败!"})}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},batchDelete(){this.multipleSelection.length<1?this.$message({message:"请先选择要删除的数据！",type:"warning"}):c.A.delete(`/notice/deleteBatch?ids=${this.multipleSelection.join(",")}`).then((t=>{"0"===t.code?(this.$message({showClose:!0,message:"批量删除成功",type:"success"}),this.onReset()):this.$message({showClose:!0,message:t.msg,type:"error"})}))},fetchData(){this.listLoading=!0,c.A.get("/notice/page",{params:{title:this.listQuery.title,currentPage:this.listQuery.currentPage,size:this.listQuery.pageSize}}).then((t=>{const e=t.data;"0"===t.code&&(this.total=e.total,this.tableData=e.records)})),this.listLoading=!1},onSubmit(){this.listQuery.currentPage=1,this.fetchData()},onReset(){this.listQuery.currentPage=1,this.listQuery.pageSize=10,this.listQuery.title="",this.fetchData()},handleAdd(t){this.$refs[t].validate((t=>t?(c.A.post("/notice",this.dialogForm).then((t=>{0==t.code?(this.$message({showClose:!0,message:"添加成功",type:"success"}),this.fetchData()):this.$message({showClose:!0,message:"添加失败",type:"error"})})),this.formVisibleAdd=!1,!0):(this.isSubmit=!1,!1)))},handleEditSave(t){this.$refs[t].validate((t=>{t&&c.A.put("/notice/"+this.dialogForm.id,this.dialogForm).then((t=>{0==t.code?(this.$message({showClose:!0,message:"更新成功",type:"success"}),this.fetchData(),this.formVisibleEdit=!1):this.$message({showClose:!0,message:t.msg,type:"error"})}))}))},exportTable(t){if(this.tableData.length){const e={header:["编号","标题","内容","发布时间"],key:["id","title","content","time"],data:this.tableData,autoWidth:!0,fileName:"通知表",bookType:t};a.Ay.exportDataToExcel(e),this.exportVisible=!1}}}},m=d,u=i(1656),p=(0,u.A)(m,l,o,!1,null,null,null),h=p.exports}}]);
//# sourceMappingURL=883.39071d06.js.map