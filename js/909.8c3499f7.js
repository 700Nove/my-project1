"use strict";(self["webpackChunkpet"]=self["webpackChunkpet"]||[]).push([[909],{6909:function(t,e,i){i.r(e),i.d(e,{default:function(){return k}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout"},[e("header",[e("NavHeader")],1),e("main",[e("router-view",{staticStyle:{flex:"1"},on:{"update:user":t.updateUser}})],1),e("footer",[e("Footer")],1)])},s=[],o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"header"},[t._m(0),e("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeMenu,mode:"horizontal",router:"","background-color":"#ffffff","text-color":"#2c3e50","active-text-color":"#5aaa95"}},[e("el-menu-item",{attrs:{index:"/frontHome"}},[e("i",{staticClass:"el-icon-s-home"}),t._v(" 首页 ")]),e("el-menu-item",{attrs:{index:"/petAdoptFront"}},[e("i",{staticClass:"el-icon-s-cooperation"}),t._v(" 宠物领养 ")]),e("el-menu-item",{attrs:{index:"/petGoods"}},[e("i",{staticClass:"el-icon-shopping-bag-1"}),t._v(" 宠物商店 ")]),e("el-menu-item",{attrs:{index:"/petServices"}},[e("i",{staticClass:"el-icon-s-tools"}),t._v(" 宠物服务 ")])],1),e("div",{staticClass:"user"},[e("el-badge",{staticClass:"notification-badge",attrs:{value:t.unreadCount,hidden:0===t.unreadCount}},[e("el-button",{staticClass:"notification-btn",attrs:{type:"text"},on:{click:t.showNotifications}},[e("i",{staticClass:"el-icon-bell"})])],1),t.userInfo?e("UserAvatar"):t._e()],1),e("el-drawer",{attrs:{title:"我的通知",visible:t.notificationDrawer,direction:"rtl",size:"400px",modal:!1,"append-to-body":!0},on:{"update:visible":function(e){t.notificationDrawer=e}}},[e("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("el-tab-pane",{attrs:{label:"未读消息",name:"unread"}},[0===t.unreadNotifications.length?e("div",{staticClass:"empty-text"},[t._v("暂无未读消息")]):e("div",{staticClass:"notification-list"},t._l(t.unreadNotifications,(function(i){return e("div",{key:i.id,staticClass:"notification-item",on:{click:function(e){return t.markAsRead(i)}}},[e("div",{staticClass:"notification-content"},[t._v(t._s(i.message))]),e("div",{staticClass:"notification-time"},[t._v(t._s(i.timestamp))])])})),0)]),e("el-tab-pane",{attrs:{label:"已读消息",name:"read"}},[0===t.readNotifications.length?e("div",{staticClass:"empty-text"},[t._v("暂无已读消息")]):e("div",{staticClass:"notification-list"},t._l(t.readNotifications,(function(i){return e("div",{key:i.id,staticClass:"notification-item"},[e("div",{staticClass:"notification-content"},[t._v(t._s(i.message))]),e("div",{staticClass:"notification-time"},[t._v(t._s(i.timestamp))])])})),0)])],1)],1)],1)},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"logo"},[e("div",{staticClass:"logo-container"},[e("div",{staticClass:"icon-wrapper"},[e("i",{staticClass:"el-icon-star-on"}),e("i",{staticClass:"el-icon-pet main-icon"}),e("i",{staticClass:"el-icon-star-on"})]),e("div",{staticClass:"text-wrapper"},[e("span",{staticClass:"logo-text"},[t._v("萌宠乐园")]),e("span",{staticClass:"logo-subtitle"},[t._v("Pet Paradise")])])])])}],r=i(3010),c=i(7120),l={name:"navHeader",inject:["userInfo"],components:{UserAvatar:r.A},data(){return{notificationDrawer:!1,activeTab:"unread",unreadNotifications:[],readNotifications:[],unreadCount:0,timer:null}},computed:{activeMenu(){return this.$route.path.includes("/petDetail")?"/petAdoptFront":this.$route.path}},created(){sessionStorage.getItem("user")&&(this.fetchNotifications(),this.timer=setInterval((()=>{sessionStorage.getItem("user")&&this.fetchNotifications()}),3e4))},beforeDestroy(){this.timer&&clearInterval(this.timer)},methods:{showNotifications(){sessionStorage.getItem("user")?(this.notificationDrawer=!0,this.fetchNotifications()):this.$message.warning("请先登录")},handleTabClick(){this.fetchNotifications()},fetchNotifications(){const t=JSON.parse(sessionStorage.getItem("user"));if(!t)return this.unreadNotifications=[],this.readNotifications=[],void(this.unreadCount=0);c.A.get(`/pet-notification/user/${t.id}`,{params:{status:"unread",currentPage:1,size:50}}).then((t=>{"0"===t.code&&t.data?(this.unreadNotifications=t.data.records||[],this.unreadCount=t.data.total||0):(this.unreadNotifications=[],this.unreadCount=0)})).catch((()=>{this.unreadNotifications=[],this.unreadCount=0})),c.A.get(`/pet-notification/user/${t.id}`,{params:{status:"read",currentPage:1,size:50}}).then((t=>{"0"===t.code&&t.data?this.readNotifications=t.data.records||[]:this.readNotifications=[]})).catch((()=>{this.readNotifications=[]}))},markAsRead(t){c.A.put(`/pet-notification/markAsRead/${t.id}`).then((t=>{"0"===t.code&&this.fetchNotifications()}))}}},d=l,u=i(1656),f=(0,u.A)(d,o,n,!1,null,"0637aa46",null),v=f.exports,h=function(){var t=this;t._self._c;return t._m(0)},m=[function(){var t=this,e=t._self._c;return e("footer",{staticClass:"footer"},[e("div",{staticClass:"footer-content"},[e("div",{staticClass:"footer-section"},[e("h3",[t._v("关于我们")]),e("p",[t._v("宠物之家致力于为每一个需要关爱的小生命找到温暖的家")])]),e("div",{staticClass:"footer-section"},[e("h3",[t._v("联系方式")]),e("div",{staticClass:"contact-info"},[e("p",[e("i",{staticClass:"el-icon-phone"}),t._v(" 123-456-789")]),e("p",[e("i",{staticClass:"el-icon-message"}),t._v(" example@example.com")])])])]),e("div",{staticClass:"footer-bottom"},[e("p",[t._v("© 2025 宠物之家 版权所有")])])])}],p={name:"Footer"},C=p,_=(0,u.A)(C,h,m,!1,null,"03debe50",null),b=_.exports,g={name:"Layout",components:{NavHeader:v,Footer:b},data(){return{userInfo:JSON.parse(sessionStorage.getItem("user")||{})}},provide(){return{userInfo:this.userInfo}},methods:{updateUser(t){this.userInfo=t}}},N=g,x=(0,u.A)(N,a,s,!1,null,"b59a503e",null),k=x.exports}}]);
//# sourceMappingURL=909.8c3499f7.js.map