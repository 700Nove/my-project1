"use strict";(self["webpackChunkpet"]=self["webpackChunkpet"]||[]).push([[803],{6803:function(e,t,r){r.r(t),r.d(t,{default:function(){return v}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-wrapper"},[t("el-card",{staticClass:"login-card"},[t("div",{staticClass:"card-content"},[t("div",{staticClass:"login-image"},[t("img",{attrs:{src:r(4366),alt:"宠物之家"}}),t("div",{staticClass:"image-overlay"})]),t("div",{staticClass:"form-container"},[t("div",{staticClass:"title-container"},[t("h1",{staticClass:"main-title"},[e._v("萌宠之家")]),t("p",{staticClass:"sub-title"},[e._v("Pet Paradise")])]),t("div",{staticClass:"toggle-container"},[t("el-button",{attrs:{type:e.isLoginActive?"primary":"",round:""},on:{click:function(t){return e.switchMode("login")}}},[e._v(" 登录 ")]),t("el-button",{attrs:{type:e.isLoginActive?"":"primary",round:""},on:{click:function(t){return e.switchMode("register")}}},[e._v(" 注册 ")])],1),e.isLoginActive?t("el-form",{ref:"loginForm",attrs:{model:e.loginForm,rules:e.loginRules}},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{placeholder:"用户名","prefix-icon":"el-icon-user",round:""},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"密码","prefix-icon":"el-icon-lock",round:""},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),t("el-form-item",[t("div",{staticClass:"verify-code-container"},[t("el-input",{staticClass:"verify-input",attrs:{placeholder:"验证码",round:""},model:{value:e.loginForm.validCode,callback:function(t){e.$set(e.loginForm,"validCode",t)},expression:"loginForm.validCode"}}),t("ValidCode",{staticClass:"valid-code",on:{input:e.createValidCode}})],1)]),t("el-form-item",[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",round:""},on:{click:e.onLogin}},[e._v(" 登录 ")])],1),t("div",{staticClass:"form-footer"},[t("span",{staticClass:"forget-link",on:{click:e.toForget}},[e._v("忘记密码?")])])],1):t("el-form",{ref:"registerForm",attrs:{model:e.registerForm,rules:e.registerRules}},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{placeholder:"用户名","prefix-icon":"el-icon-user",round:""},model:{value:e.registerForm.username,callback:function(t){e.$set(e.registerForm,"username",t)},expression:"registerForm.username"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"密码","prefix-icon":"el-icon-lock",round:""},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password",t)},expression:"registerForm.password"}})],1),t("el-form-item",{attrs:{prop:"email"}},[t("el-input",{attrs:{placeholder:"邮箱","prefix-icon":"el-icon-message",round:""},model:{value:e.registerForm.email,callback:function(t){e.$set(e.registerForm,"email",t)},expression:"registerForm.email"}})],1),t("el-form-item",{attrs:{prop:"code"}},[t("div",{staticClass:"verify-code-container"},[t("el-input",{staticClass:"verify-input",attrs:{placeholder:"邮箱验证码",round:""},model:{value:e.registerForm.code,callback:function(t){e.$set(e.registerForm,"code",t)},expression:"registerForm.code"}}),t("el-button",{staticClass:"verify-btn",attrs:{type:"primary",round:"",disabled:e.sendDisabled},on:{click:e.sendVerificationCode}},[e._v(" "+e._s(e.buttonContent)+" ")])],1)]),t("el-form-item",{attrs:{prop:"role"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择身份"},model:{value:e.registerForm.role,callback:function(t){e.$set(e.registerForm,"role",t)},expression:"registerForm.role"}},[t("el-option",{attrs:{label:"普通用户",value:"USER"}}),t("el-option",{attrs:{label:"管理员",value:"ADMIN"}})],1)],1),"ADMIN"===e.registerForm.role?[t("el-form-item",{attrs:{prop:"invitationCode"}},[t("el-input",{attrs:{placeholder:"邀请码","prefix-icon":"el-icon-unlock",round:""},model:{value:e.registerForm.invitationCode,callback:function(t){e.$set(e.registerForm,"invitationCode",t)},expression:"registerForm.invitationCode"}})],1)]:e._e(),t("el-form-item",[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",round:""},on:{click:e.onRegister}},[e._v(" 注册 ")])],1)],2)],1)])])],1)},o=[],i=(r(4114),function(){var e=this,t=e._self._c;return t("div",{staticClass:"ValidCode disabled-select",style:`width:${e.width}; height:${e.height}`,on:{click:e.refreshCode}},e._l(e.codeList,(function(r,s){return t("span",{key:s,style:e.getStyle(r)},[e._v(e._s(r.code))])})),0)}),a=[],n={name:"ValidCode",model:{prop:"value",event:"input"},props:{width:{type:String,default:"100px"},height:{type:String,default:"40px"},length:{type:Number,default:4},refresh:{type:Number}},data(){return{codeList:[]}},watch:{refresh(){this.createdCode()}},mounted(){this.createdCode()},methods:{refreshCode(){this.createdCode()},createdCode(){const e=this.length,t=[],r="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz0123456789",s=r.length;for(let o=0;o<e;o++){const e=[Math.round(220*Math.random()),Math.round(240*Math.random()),Math.round(200*Math.random())];t.push({code:r.charAt(Math.floor(Math.random()*s)),color:`rgb(${e})`,fontSize:+[Math.floor(10*Math.random())]+6+10+"px",padding:`${[Math.floor(10*Math.random())]}px`,transform:`rotate(${Math.floor(90*Math.random())-Math.floor(90*Math.random())}deg)`})}this.codeList=t,this.$emit("input",t.map((e=>e.code)).join(""))},getStyle(e){return`color: ${e.color}; font-size: ${e.fontSize}; padding: ${e.padding}; transform: ${e.transform}`}}},l=n,d=r(1656),m=(0,d.A)(l,i,a,!1,null,"43a2c60e",null),c=m.exports,u=r(7120),g=r(5441),p={name:"Login",components:{ValidCode:c},data(){return{adminVitationCode:"123456",countdown:0,sendDisabled:!1,timer:null,emailCode:"",buttonContent:"发送验证码",validCode:"",isLoginActive:!0,loginForm:{username:"",password:"",validCode:""},registerForm:{username:"",password:"",email:"",code:"",role:"USER",invitationCode:""},loginRules:{username:[{required:!0,message:"请输入用户名",trigger:["blur","change"]},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]},registerRules:{username:[{required:!0,message:"请输入用户名"},{min:3,max:20,message:"长度在 3 到 20 个字符"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}],invitationCode:[{required:!0,message:"请输入邀请码",trigger:"blur"},{min:6,max:6,message:"邀请码长度必须为6位",trigger:"blur"}]}}},methods:{switchMode(e){this.isLoginActive="login"===e,0==this.isLoginActive?this.$nextTick((()=>{this.$refs["registerForm"].clearValidate()})):this.$nextTick((()=>{this.$refs["loginForm"].clearValidate()}))},sendVerificationCode(){this.sendDisabled||(u.A.post("/email/sendEmail",this.registerForm).then((e=>{"0"==e.code?(this.$message({type:"success",message:"验证码已发送到您的邮箱,请查收"}),this.emailCode=e.data):this.$message({type:"error",message:e.msg})})),this.countdown=60,this.sendDisabled=!0,this.buttonContent=`${this.countdown}秒后可重发`,this.timer=setInterval((()=>{this.countdown>0?(this.countdown--,this.buttonContent=`${this.countdown}秒后可重发`):(clearInterval(this.timer),this.countdown=0,this.sendDisabled=!1,this.buttonContent="发送验证码")}),1e3))},onRegister(){this.$refs.registerForm.validate((e=>{if(!e)return console.error("注册失败: 表单校验失败"),!1;this.registerForm.code==this.emailCode?"ADMIN"!=this.registerForm.role||this.registerForm.invitationCode==this.adminVitationCode?u.A.post("/user",this.registerForm).then((e=>{"0"==e.code?(this.$message({type:"success",message:"注册成功"}),this.$router.push({path:"/completeInfo",query:{registerUser:e.data}})):this.$message({type:"error",message:e.msg})})):this.$message({type:"error",message:"邀请码错误"}):this.$message({type:"error",message:"验证码不正确"})}))},toForget(){this.$router.push("/forget")},createValidCode(e){this.validCode=e},onLogin(){this.$refs.loginForm.validate((e=>{if(!e)return console.error("登录失败: 表单校验失败"),!1;this.loginForm.validCode?this.loginForm.validCode.toLowerCase()===this.validCode.toLowerCase()?u.A.post("/user/login",this.loginForm).then((e=>{"0"===e.code?(this.$message({showClose:!0,message:"登录成功",type:"success"}),sessionStorage.setItem("user",JSON.stringify(e.data)),sessionStorage.setItem("userMenuList",JSON.stringify(e.data.menuList)),(0,g.z)(),"USER"==e.data.role?this.$router.push("/front"):this.$router.push("/showView")):this.$message({showClose:!0,message:e.msg,type:"error"})})):this.$message({showClose:!0,message:"验证码错误",type:"error"}):this.$message({showClose:!0,message:"请填写验证码",type:"error"})}))}},beforeDestroy(){clearInterval(this.timer)}},h=p,f=(0,d.A)(h,s,o,!1,null,"b7180fe2",null),v=f.exports},4366:function(e,t,r){e.exports=r.p+"img/猫狗双全.d1e6ed03.png"}}]);
//# sourceMappingURL=803.148298cf.js.map