"use strict";(self["webpackChunkpet"]=self["webpackChunkpet"]||[]).push([[256],{8256:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"training-wrapper"},[t("el-card",{attrs:{shadow:"always"}},[t("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{inline:!0,model:e.listQuery,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"训练服务类型"}},[t("el-select",{attrs:{placeholder:"请选择训练服务类型"},model:{value:e.listQuery.serviceType,callback:function(t){e.$set(e.listQuery,"serviceType",t)},expression:"listQuery.serviceType"}},e._l(e.serviceTypeList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1),t("el-form-item",[t("el-button",{attrs:{type:"danger"},on:{click:e.onReset}},[e._v("重置")])],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t("el-table-column",{attrs:{prop:"petName",label:"宠物名称"}}),t("el-table-column",{attrs:{prop:"userName",label:"用户名"}}),t("el-table-column",{attrs:{prop:"serviceType",label:"训练服务类型","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"endDate",label:"预计结束日期","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"trainingLevel",label:"训练级别","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"trainingGoals",label:"训练目标","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"completionStatus",label:"完成状态","show-overflow-tooltip":""}}),"USER"!=e.userInfo.role?t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(i){return["未开始"===i.row.completionStatus?t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(i.$index,i.row)}}},[e._v("编辑")]):e._e(),"完成"===i.row.completionStatus?t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(i.$index,i.row)}}},[e._v("删除")]):e._e(),"未开始"===i.row.completionStatus?t("el-button",{attrs:{plain:"",type:"warning",size:"mini"},on:{click:function(t){return e.handleModifyTraining(i.$index,i.row,"训练中")}}},[e._v("开始训练")]):"训练中"===i.row.completionStatus?t("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(t){return e.handleModifyTraining(i.$index,i.row,"完成")}}},[e._v("训练结束")]):t("el-button",{attrs:{plain:"",type:"success",size:"mini",disabled:""}},[e._v("已结束")])]}}],null,!1,762349300)}):e._e()],1),t("Pagination",{attrs:{total:e.total,page:e.listQuery.currentPage,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"currentPage",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.fetchData}}),t("el-dialog",{staticClass:"dialog-form",attrs:{title:"修改训练服务",visible:e.formVisibleEdit,width:"30%",modal:!1},on:{"update:visible":function(t){e.formVisibleEdit=t}}},[t("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.formRules,"label-width":"120px"}},[t("el-form-item",{attrs:{prop:"userName",label:"用户名"}},[t("el-input",{attrs:{disabled:!0,autocomplete:"off"},model:{value:e.dialogForm.userName,callback:function(t){e.$set(e.dialogForm,"userName",t)},expression:"dialogForm.userName"}})],1),t("el-form-item",{attrs:{prop:"petName",label:"宠物"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.dialogForm.petName,callback:function(t){e.$set(e.dialogForm,"petName",t)},expression:"dialogForm.petName"}})],1),t("el-form-item",{attrs:{prop:"serviceType",label:"训练服务类型"}},[t("el-select",{attrs:{placeholder:"请选择训练服务类型"},model:{value:e.dialogForm.serviceType,callback:function(t){e.$set(e.dialogForm,"serviceType",t)},expression:"dialogForm.serviceType"}},e._l(e.serviceTypeList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),t("el-form-item",{attrs:{prop:"endDate",label:"预计结束日期"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.dialogForm.endDate,callback:function(t){e.$set(e.dialogForm,"endDate",t)},expression:"dialogForm.endDate"}})],1),t("el-form-item",{attrs:{prop:"trainingLevel",label:"训练级别"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.dialogForm.trainingLevel,callback:function(t){e.$set(e.dialogForm,"trainingLevel",t)},expression:"dialogForm.trainingLevel"}})],1),t("el-form-item",{attrs:{prop:"trainingGoals",label:"训练目标"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.dialogForm.trainingGoals,callback:function(t){e.$set(e.dialogForm,"trainingGoals",t)},expression:"dialogForm.trainingGoals"}})],1),t("div",{staticClass:"footer-item"},[t("el-button",{on:{click:function(t){e.formVisibleEdit=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",disabled:e.isSubmit},on:{click:function(t){return e.handleEditSave("dialogForm")}}},[e._v("确 定")])],1)],1)],1)],1)],1)},l=[],r=(i(186),i(1184)),s=i(1867),o=i(193),n=i(7120),c={inject:["userInfo"],name:"TrainingManager",components:{Pagination:r.A,Upload:s.A,Hints:o.A},data(){return{uploadUrl:"/api/file/upload",listLoading:!0,listQuery:{serviceType:void 0,currentPage:1,pageSize:10},dialogForm:{petName:"",serviceType:"",endDate:"",trainingLevel:"",trainingGoals:""},total:0,tableData:[],multipleSelection:[],formVisibleEdit:!1,serviceTypeList:[],formRules:{serviceType:[{required:!0,message:"请选择训练服务类型",trigger:"blur"}],endDate:[{required:!0,message:"请选择预计结束日期",trigger:"blur"},{type:"date",validator:this.validateEndDate,trigger:"change"}],trainingLevel:[{required:!0,message:"请输入训练级别",trigger:"blur"}],trainingGoals:[{required:!0,message:"请输入训练目标",trigger:"blur"}],petName:[{required:!0,message:"宠物名称",trigger:"blur"}]},isSubmit:!1}},created(){this.loadServiceType(),this.fetchData()},methods:{validateEndDate(e,t,i){if(t){const e=new Date(t),a=new Date;e.getTime()<a.getTime()?i(new Error("预计结束日期不得早于当前日期")):i()}else i()},handleSelectionChange(e){this.multipleSelection=e.map((e=>e.id))},handleEdit(e,t){this.dialogForm=JSON.parse(JSON.stringify(t)),this.formVisibleEdit=!0},loadServiceType(){n.A.get("/trainingName/selectAll").then((e=>{0==e.code&&(this.serviceTypeList=e.data)}))},handleDelete(e,t){this.$confirm("此操作将删除选中数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{n.A.delete("/petTrainingService/"+t.id).then((e=>{0==e.code?(this.$message({type:"success",message:"删除成功!"}),this.onReset()):this.$message({type:"success",error:e.msg})}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleModifyTraining(e,t,i){var a=JSON.parse(JSON.stringify(t));a.completionStatus=i,n.A.put("/petTrainingService/"+a.id,a).then((e=>{0==e.code?(this.$message({showClose:!0,message:"修改成功",type:"success"}),this.fetchData()):this.$message({showClose:!0,message:e.msg,type:"error"})}))},handleEndTraining(e,t){},handleEditSave(e){this.$refs[e].validate((e=>{if(!e)return this.isSubmit=!1,!1;n.A.put("/petTrainingService/"+this.dialogForm.id,this.dialogForm).then((e=>{0==e.code?(this.$message({showClose:!0,message:"更新成功",type:"success"}),this.formVisibleEdit=!1,this.fetchData()):this.$message({showClose:!0,message:e.msg,type:"error"})}))}))},fetchData(){this.listLoading=!0,n.A.get("/petTrainingService/selectPage",{params:{username:"USER"==this.userInfo.role?this.userInfo.username:"",serviceType:this.listQuery.serviceType,currentPage:this.listQuery.currentPage,pageSize:this.listQuery.pageSize}}).then((e=>{const t=e.data;"0"===e.code&&(this.total=t.total,this.tableData=t.records,console.log(this.userInfo))})),this.listLoading=!1},onSubmit(){this.listQuery.currentPage=1,this.fetchData()},onReset(){this.listQuery.currentPage=1,this.listQuery.pageSize=10,this.listQuery.serviceType="",this.fetchData()}}},u=c,m=i(1656),p=(0,m.A)(u,a,l,!1,null,"14cb1c3c",null),d=p.exports}}]);
//# sourceMappingURL=256.7fd11d19.js.map