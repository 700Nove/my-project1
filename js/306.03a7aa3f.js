"use strict";(self["webpackChunkpet"]=self["webpackChunkpet"]||[]).push([[306],{7306:function(t,e,i){i.r(e),i.d(e,{default:function(){return p}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"room-manager"},[e("el-card",{staticClass:"main-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"action-bar"},[e("div",{staticClass:"left-actions"},[e("el-popconfirm",{attrs:{title:"确认删除?"},on:{confirm:t.batchDelete},scopedSlots:t._u([{key:"reference",fn:function(){return[e("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"medium"}},[t._v("批量删除")])]},proxy:!0}])})],1),e("div",{staticClass:"right-actions"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"medium"},on:{click:t.handleCreate}},[t._v("添加房间")]),e("el-button",{attrs:{type:"success",icon:"el-icon-download",size:"medium"},on:{click:function(e){t.exportVisible=!0}}},[t._v("导出数据")])],1)]),e("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{inline:!0,model:t.listQuery}},[e("el-form-item",{attrs:{label:"房间编号"}},[e("el-input",{attrs:{placeholder:"请输入房间编号","prefix-icon":"el-icon-search"},model:{value:t.listQuery.name,callback:function(e){t.$set(t.listQuery,"name",e)},expression:"listQuery.name"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.onSubmit}},[t._v("查询")]),e("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.onReset}},[t._v("重置")])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"multipleTable",staticClass:"room-table",attrs:{data:t.tableData,border:"",stripe:""},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e("el-table-column",{attrs:{prop:"id",label:"序号",width:"80",align:"center",sortable:""}}),e("el-table-column",{attrs:{prop:"name",label:"房间编号","min-width":"120"}}),e("el-table-column",{attrs:{prop:"status",label:"房间状态",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-tag",{attrs:{type:"空闲"===i.row.status?"success":"warning",size:"small"}},[t._v(" "+t._s(i.row.status)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"animal",label:"寄养宠物","min-width":"120"}}),e("el-table-column",{attrs:{label:"操作",width:"180",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(e){return t.handleEdit(i.$index,i.row)}}},[t._v("编辑")]),e("el-button",{staticClass:"delete-btn",attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(e){return t.handleDelete(i.$index,i.row)}}},[t._v("删除")])]}}])})],1),e("div",{staticClass:"pagination-container"},[e("Pagination",{attrs:{total:t.total,page:t.listQuery.currentPage,limit:t.listQuery.pageSize},on:{"update:page":function(e){return t.$set(t.listQuery,"currentPage",e)},"update:limit":function(e){return t.$set(t.listQuery,"pageSize",e)},pagination:t.fetchData}})],1)],1),e("el-dialog",{staticClass:"room-dialog",attrs:{title:"添加房间",visible:t.formVisibleAdd,width:"500px","close-on-click-modal":!1,modal:!1},on:{"update:visible":function(e){t.formVisibleAdd=e}}},[e("el-form",{ref:"dialogForm",staticClass:"dialog-form",attrs:{model:t.dialogForm,rules:t.formRules,"label-width":"100px"}},[e("el-form-item",{attrs:{prop:"name",label:"房间编号"}},[e("el-input",{attrs:{placeholder:"请输入房间编号"},model:{value:t.dialogForm.name,callback:function(e){t.$set(t.dialogForm,"name",e)},expression:"dialogForm.name"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.formVisibleAdd=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",disabled:t.isSubmit},on:{click:function(e){return t.handleAdd("dialogForm")}}},[t._v("确 定")])],1)],1),e("el-dialog",{staticClass:"room-dialog",attrs:{title:"修改房间信息",visible:t.formVisibleEdit,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(e){t.formVisibleEdit=e}}},[e("el-form",{ref:"dialogForm",staticClass:"dialog-form",attrs:{model:t.dialogForm,rules:t.formRules,"label-width":"100px"}},[e("el-form-item",{attrs:{prop:"name",label:"房间编号"}},[e("el-input",{attrs:{placeholder:"请输入房间编号"},model:{value:t.dialogForm.name,callback:function(e){t.$set(t.dialogForm,"name",e)},expression:"dialogForm.name"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.formVisibleEdit=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",disabled:t.isSubmit},on:{click:function(e){return t.handleEditSave("dialogForm")}}},[t._v("确 定")])],1)],1),e("el-dialog",{staticClass:"export-dialog",attrs:{title:"导出数据",visible:t.exportVisible,width:"500px"},on:{"update:visible":function(e){t.exportVisible=e}}},[e("div",{staticClass:"export-options"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-document"},on:{click:function(e){return t.exportTable("xlsx")}}},[t._v("EXCEL格式")]),e("el-button",{attrs:{type:"success",icon:"el-icon-document"},on:{click:function(e){return t.exportTable("csv")}}},[t._v("CSV格式")]),e("el-button",{attrs:{type:"info",icon:"el-icon-document"},on:{click:function(e){return t.exportTable("txt")}}},[t._v("TXT格式")])],1),e("div",{staticClass:"export-tip"},[t._v("请选择要导出数据的格式")])])],1)},a=[],l=i(186),o=i(1184),n=i(1867),r=i(193),c=i(7120),m={inject:["userInfo"],name:"Room",components:{Pagination:o.A,Upload:n.A,Hints:r.A},data(){return{uploadUrl:"/api/file/upload",imgBaseUrl:this.HOST,listLoading:!0,listQuery:{name:void 0,currentPage:1,pageSize:10},dialogForm:{name:""},total:0,tableData:[],multipleSelection:[],formVisible:!1,formVisibleAdd:!1,formVisibleEdit:!1,categoryList:[],formRules:{name:[{required:!0,message:"请输入房间编号",trigger:"blur"}]},isSubmit:!1,filesFormat:".txt, .csv, .xls, .xlsx",exportVisible:!1}},created(){this.fetchData()},methods:{handleSelectionChange(t){this.multipleSelection=t.map((t=>t.id))},handleCreate(){this.formVisibleAdd=!0,this.dialogForm={name:""}},handleEdit(t,e){this.dialogForm=JSON.parse(JSON.stringify(e)),this.formVisibleEdit=!0},handleAdd(t){this.$refs[t].validate((t=>t?(this.isSubmit=!0,c.A.post("/room",this.dialogForm).then((t=>{0==t.code?(this.$message({showClose:!0,message:"房间添加成功",type:"success"}),this.formVisibleAdd=!1,this.fetchData()):this.$message({showClose:!0,message:t.msg,type:"error"}),this.isSubmit=!1})).catch((()=>{this.isSubmit=!1})),!0):(this.isSubmit=!1,!1)))},handleDelete(t,e){this.$confirm("此操作将删除选中数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{c.A.delete("/room/"+e.id).then((t=>{0==t.code?(this.$message({type:"success",message:"删除成功!"}),this.onReset()):this.$message({type:"error",message:t.msg||"删除失败!"})}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},batchDelete(){this.multipleSelection.length<1?this.$message({message:"请先选择要删除的数据！",type:"warning"}):c.A.delete(`/room/deleteBatch?ids=${this.multipleSelection.join(",")}`).then((t=>{"0"===t.code?(this.$message({showClose:!0,message:"批量删除成功",type:"success"}),this.onReset()):this.$message({showClose:!0,message:t.msg,type:"error"})}))},fetchData(){this.listLoading=!0,c.A.get("/room/selectPage",{params:{name:this.listQuery.name,pageNum:this.listQuery.currentPage,size:this.listQuery.pageSize}}).then((t=>{const e=t.data;"0"===t.code&&(this.total=e.total,this.tableData=e.records),this.listLoading=!1})).catch((()=>{this.listLoading=!1}))},onSubmit(){this.listQuery.currentPage=1,this.fetchData()},onReset(){this.listQuery.currentPage=1,this.listQuery.pageSize=10,this.listQuery.name="",this.fetchData()},handleEditSave(t){this.$refs[t].validate((t=>{t?(this.isSubmit=!0,c.A.put("/room/"+this.dialogForm.id,this.dialogForm).then((t=>{0==t.code?(this.$message({showClose:!0,message:"更新成功",type:"success"}),this.formVisibleEdit=!1,this.fetchData()):this.$message({showClose:!0,message:t.msg||"更新失败",type:"error"}),this.isSubmit=!1})).catch((()=>{this.isSubmit=!1}))):this.isSubmit=!1}))},exportTable(t){if(this.tableData.length){const e={header:["序号","房间编号","房间状态","寄养宠物"],key:["id","name","status","animal"],data:this.tableData,autoWidth:!0,fileName:"房间信息表",bookType:t};l.Ay.exportDataToExcel(e),this.exportVisible=!1}}}},d=m,u=i(1656),h=(0,u.A)(d,s,a,!1,null,null,null),p=h.exports}}]);
//# sourceMappingURL=306.03a7aa3f.js.map