{"version":3,"file":"js/986.feb04bcf.js","mappings":"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","sources":["webpack://pet/./src/views/PetNotificationManagement.vue","webpack://pet/src/views/PetNotificationManagement.vue","webpack://pet/./src/views/PetNotificationManagement.vue?8a03","webpack://pet/./src/views/PetNotificationManagement.vue?d88e"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"notification-wrapper\"},[_c('el-card',{attrs:{\"shadow\":\"always\"}},[_c('div',{staticClass:\"control-btns\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleSendNotification}},[_vm._v(\"发送通知\")]),_c('el-button',{attrs:{\"type\":\"danger\"},on:{\"click\":_vm.batchDelete}},[_vm._v(\"批量删除\")])],1),_c('el-form',{ref:\"searchForm\",staticClass:\"search-form\",attrs:{\"inline\":true,\"model\":_vm.listQuery,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"用户名\"}},[_c('el-input',{attrs:{\"placeholder\":\"用户名\"},model:{value:(_vm.listQuery.username),callback:function ($$v) {_vm.$set(_vm.listQuery, \"username\", $$v)},expression:\"listQuery.username\"}})],1),_c('el-form-item',{attrs:{\"label\":\"状态\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择状态\"},model:{value:(_vm.listQuery.status),callback:function ($$v) {_vm.$set(_vm.listQuery, \"status\", $$v)},expression:\"listQuery.status\"}},[_c('el-option',{attrs:{\"label\":\"未读\",\"value\":\"unread\"}}),_c('el-option',{attrs:{\"label\":\"已读\",\"value\":\"read\"}})],1)],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSubmit}},[_vm._v(\"查询\")]),_c('el-button',{on:{\"click\":_vm.onReset}},[_vm._v(\"重置\")])],1)],1),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.listLoading),expression:\"listLoading\"}],staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.tableData},on:{\"selection-change\":_vm.handleSelectionChange}},[_c('el-table-column',{attrs:{\"type\":\"selection\",\"width\":\"55\"}}),_c('el-table-column',{attrs:{\"prop\":\"username\",\"label\":\"用户名\"}}),_c('el-table-column',{attrs:{\"prop\":\"message\",\"label\":\"消息内容\",\"show-overflow-tooltip\":\"\"}}),_c('el-table-column',{attrs:{\"prop\":\"timestamp\",\"label\":\"发送时间\",\"width\":\"180\"}}),_c('el-table-column',{attrs:{\"prop\":\"status\",\"label\":\"状态\",\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-tag',{attrs:{\"type\":scope.row.status === 'unread' ? 'warning' : 'success'}},[_vm._v(\" \"+_vm._s(scope.row.status === 'unread' ? '未读' : '已读')+\" \")])]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"200\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.status === 'unread')?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"primary\"},on:{\"click\":function($event){return _vm.markAsRead(scope.row)}}},[_vm._v(\"标记已读\")]):_vm._e(),_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.handleDelete(scope.row)}}},[_vm._v(\"删除\")])]}}])})],1),_c('Pagination',{attrs:{\"total\":_vm.total,\"page\":_vm.listQuery.currentPage,\"limit\":_vm.listQuery.size},on:{\"update:page\":function($event){return _vm.$set(_vm.listQuery, \"currentPage\", $event)},\"update:limit\":function($event){return _vm.$set(_vm.listQuery, \"size\", $event)},\"pagination\":_vm.fetchData}}),_c('el-dialog',{attrs:{\"title\":\"发送通知\",\"visible\":_vm.dialogVisible,\"width\":\"500px\",\"modal\":false},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{ref:\"notificationForm\",attrs:{\"model\":_vm.notificationForm,\"rules\":_vm.rules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"发送对象\",\"prop\":\"sendType\"}},[_c('el-radio-group',{on:{\"change\":_vm.handleSendTypeChange},model:{value:(_vm.notificationForm.sendType),callback:function ($$v) {_vm.$set(_vm.notificationForm, \"sendType\", $$v)},expression:\"notificationForm.sendType\"}},[_c('el-radio',{attrs:{\"label\":\"role\"}},[_vm._v(\"按角色发送\")]),_c('el-radio',{attrs:{\"label\":\"user\"}},[_vm._v(\"按用户发送\")])],1)],1),(_vm.notificationForm.sendType === 'role')?_c('el-form-item',{attrs:{\"label\":\"选择角色\",\"prop\":\"role\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择角色\"},model:{value:(_vm.notificationForm.role),callback:function ($$v) {_vm.$set(_vm.notificationForm, \"role\", $$v)},expression:\"notificationForm.role\"}},[_c('el-option',{attrs:{\"label\":\"普通用户\",\"value\":\"USER\"}}),_c('el-option',{attrs:{\"label\":\"管理员\",\"value\":\"ADMIN\"}})],1)],1):_vm._e(),(_vm.notificationForm.sendType === 'user')?_c('el-form-item',{attrs:{\"label\":\"选择用户\",\"prop\":\"userId\"}},[_c('el-select',{attrs:{\"placeholder\":\"请输入用户名搜索\",\"filterable\":\"\",\"remote\":\"\",\"reserve-keyword\":\"\",\"remote-method\":_vm.remoteSearchUsers,\"loading\":_vm.userLoading},model:{value:(_vm.notificationForm.userId),callback:function ($$v) {_vm.$set(_vm.notificationForm, \"userId\", $$v)},expression:\"notificationForm.userId\"}},_vm._l((_vm.userList),function(user){return _c('el-option',{key:user.id,attrs:{\"label\":user.username,\"value\":user.id}},[_c('span',{staticStyle:{\"float\":\"left\"}},[_vm._v(_vm._s(user.username))]),_c('span',{staticStyle:{\"float\":\"right\",\"color\":\"#8492a6\",\"font-size\":\"13px\"}},[_vm._v(_vm._s(user.email))])])}),1)],1):_vm._e(),_c('el-form-item',{attrs:{\"label\":\"消息内容\",\"prop\":\"message\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":4,\"placeholder\":\"请输入消息内容\"},model:{value:(_vm.notificationForm.message),callback:function ($$v) {_vm.$set(_vm.notificationForm, \"message\", $$v)},expression:\"notificationForm.message\"}})],1)],1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submitNotification}},[_vm._v(\"确 定\")])],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"notification-wrapper\">\n    <el-card shadow=\"always\">\n      <!-- 操作栏 -->\n      <div class=\"control-btns\">\n        <el-button type=\"primary\" @click=\"handleSendNotification\">发送通知</el-button>\n        <el-button type=\"danger\" @click=\"batchDelete\">批量删除</el-button>\n      </div>\n\n      <!-- 查询栏 -->\n      <el-form ref=\"searchForm\" :inline=\"true\" :model=\"listQuery\" label-width=\"80px\" class=\"search-form\">\n        <el-form-item label=\"用户名\">\n          <el-input v-model=\"listQuery.username\" placeholder=\"用户名\" />\n        </el-form-item>\n        <el-form-item label=\"状态\">\n          <el-select v-model=\"listQuery.status\" placeholder=\"请选择状态\">\n            <el-option label=\"未读\" value=\"unread\" />\n            <el-option label=\"已读\" value=\"read\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"onSubmit\">查询</el-button>\n          <el-button @click=\"onReset\">重置</el-button>\n        </el-form-item>\n      </el-form>\n\n      <!-- 通知列表 -->\n      <el-table :data=\"tableData\" style=\"width: 100%\" @selection-change=\"handleSelectionChange\" v-loading=\"listLoading\">\n        <el-table-column type=\"selection\" width=\"55\" />\n        <el-table-column prop=\"username\" label=\"用户名\" />\n        <el-table-column prop=\"message\" label=\"消息内容\" show-overflow-tooltip />\n        <el-table-column prop=\"timestamp\" label=\"发送时间\" width=\"180\" />\n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\n          <template slot-scope=\"scope\">\n            <el-tag :type=\"scope.row.status === 'unread' ? 'warning' : 'success'\">\n              {{ scope.row.status === 'unread' ? '未读' : '已读' }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" width=\"200\">\n          <template slot-scope=\"scope\">\n            <el-button \n              size=\"mini\" \n              type=\"primary\" \n              @click=\"markAsRead(scope.row)\"\n              v-if=\"scope.row.status === 'unread'\"\n            >标记已读</el-button>\n            <el-button \n              size=\"mini\" \n              type=\"danger\" \n              @click=\"handleDelete(scope.row)\"\n            >删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <!-- 分页 -->\n      <Pagination \n        :total=\"total\" \n        :page.sync=\"listQuery.currentPage\" \n        :limit.sync=\"listQuery.size\" \n        @pagination=\"fetchData\" \n      />\n\n      <!-- 发送通知对话框 -->\n      <el-dialog title=\"发送通知\" :visible.sync=\"dialogVisible\" width=\"500px\" :modal=\"false\">\n        <el-form :model=\"notificationForm\" :rules=\"rules\" ref=\"notificationForm\" label-width=\"100px\">\n          <el-form-item label=\"发送对象\" prop=\"sendType\">\n            <el-radio-group v-model=\"notificationForm.sendType\" @change=\"handleSendTypeChange\">\n              <el-radio label=\"role\">按角色发送</el-radio>\n              <el-radio label=\"user\">按用户发送</el-radio>\n            </el-radio-group>\n          </el-form-item>\n\n          <el-form-item label=\"选择角色\" v-if=\"notificationForm.sendType === 'role'\" prop=\"role\">\n            <el-select v-model=\"notificationForm.role\" placeholder=\"请选择角色\">\n              <el-option label=\"普通用户\" value=\"USER\" />\n              <el-option label=\"管理员\" value=\"ADMIN\" />\n            </el-select>\n          </el-form-item>\n\n          <el-form-item label=\"选择用户\" v-if=\"notificationForm.sendType === 'user'\" prop=\"userId\">\n            <el-select\n              v-model=\"notificationForm.userId\"\n              placeholder=\"请输入用户名搜索\"\n              filterable\n              remote\n              reserve-keyword\n              :remote-method=\"remoteSearchUsers\"\n              :loading=\"userLoading\"\n            >\n              <el-option\n                v-for=\"user in userList\"\n                :key=\"user.id\"\n                :label=\"user.username\"\n                :value=\"user.id\"\n              >\n                <span style=\"float: left\">{{ user.username }}</span>\n                <span style=\"float: right; color: #8492a6; font-size: 13px\">{{ user.email }}</span>\n              </el-option>\n            </el-select>\n          </el-form-item>\n\n          <el-form-item label=\"消息内容\" prop=\"message\">\n            <el-input \n              type=\"textarea\" \n              v-model=\"notificationForm.message\" \n              :rows=\"4\" \n              placeholder=\"请输入消息内容\"\n            />\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"dialogVisible = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"submitNotification\">确 定</el-button>\n        </div>\n      </el-dialog>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport Pagination from '../components/Pagination/index.vue'\nimport Request from '../utils/request.js'\n\nexport default {\n  name: 'NotificationManagement',\n  components: { Pagination },\n  data() {\n    return {\n      listLoading: true,\n      listQuery: {\n        username: '',\n        status: '',\n        currentPage: 1,\n        size: 10\n      },\n      total: 0,\n      tableData: [],\n      multipleSelection: [],\n      dialogVisible: false,\n      userList: [],\n      userLoading: false,\n      userQuery: '',\n      timeout: null,\n      notificationForm: {\n        sendType: 'role',\n        role: null,\n        userId: null,\n        message: ''\n      },\n      rules: {\n        sendType: [{ required: true, message: '请选择发送对象', trigger: 'change' }],\n        role: [{ required: true, message: '请选择角色', trigger: 'change' }],\n        userId: [{ required: true, message: '请选择用户', trigger: 'change' }],\n        message: [{ required: true, message: '请输入消息内容', trigger: 'blur' }]\n      }\n    }\n  },\n  mounted() {\n    this.fetchData()\n  },\n  methods: {\n    formatDateTime(timestamp) {\n      if (!timestamp) return ''\n      const date = new Date(timestamp)\n      const year = date.getFullYear()\n      const month = String(date.getMonth() + 1).padStart(2, '0')\n      const day = String(date.getDate()).padStart(2, '0')\n      const hours = String(date.getHours()).padStart(2, '0')\n      const minutes = String(date.getMinutes()).padStart(2, '0')\n      const seconds = String(date.getSeconds()).padStart(2, '0')\n      \n      return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`\n    },\n\n    fetchData() {\n      this.listLoading = true\n      Request.get('/pet-notification/page', {\n        params: this.listQuery\n      }).then(response => {\n        if (response.code === '0' && response.data) {\n          this.total = response.data.total\n          this.tableData = (response.data.records || []).map(item => ({\n            ...item,\n            timestamp: this.formatDateTime(item.timestamp)\n          }))\n        }\n        this.listLoading = false\n      }).catch(() => {\n        this.listLoading = false\n      })\n    },\n\n    handleSendNotification() {\n      this.dialogVisible = true\n      this.notificationForm = {\n        sendType: 'role',\n        role: null,\n        userId: null,\n        message: ''\n      }\n      this.userList = []\n    },\n\n    submitNotification() {\n      this.$refs.notificationForm.validate(valid => {\n        if (valid) {\n          const url = this.notificationForm.sendType === 'role' \n            ? `/pet-notification/role/${this.notificationForm.role}`\n            : `/pet-notification/user/${this.notificationForm.userId}`\n\n          Request.post(url, {\n            message: this.notificationForm.message\n          }).then(response => {\n            if (response.code === '0') {\n              this.$message.success('发送成功')\n              this.dialogVisible = false\n              this.fetchData()\n            }else{\n              this.$message.error(response.message||\"发送失败\")\n            }\n          })\n        }\n      })\n    },\n\n    handleSelectionChange(val) {\n      this.multipleSelection = val.map(item => item.id)\n    },\n\n    markAsRead(row) {\n      Request.put(`/pet-notification/markAsRead/${row.id}`).then(response => {\n        if (response.code === '0') {\n          this.$message.success('标记成功')\n          this.fetchData()\n        }\n      })\n    },\n\n    handleDelete(row) {\n      this.$confirm('确认删除该通知?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        Request.delete(`/pet-notification/${row.id}`).then(response => {\n          if (response.code === '0') {\n            this.$message.success('删除成功')\n            this.fetchData()\n          }\n        })\n      })\n    },\n\n    batchDelete() {\n      if (this.multipleSelection.length === 0) {\n        this.$message.warning('请选择要删除的记录')\n        return\n      }\n\n      this.$confirm('确认删除选中的通知?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        Request.delete(`/pet-notification/deleteBatch?ids=${this.multipleSelection.join(',')}`).then(response => {\n          if (response.code === '0') {\n            this.$message.success('批量删除成功')\n            this.fetchData()\n          }\n        })\n      })\n    },\n\n    onSubmit() {\n      this.listQuery.currentPage = 1\n      this.fetchData()\n    },\n\n    onReset() {\n      this.listQuery = {\n        username: '',\n        status: '',\n        currentPage: 1,\n        size: 10\n      }\n      this.fetchData()\n    },\n\n    remoteSearchUsers(query) {\n      if (query !== '') {\n        this.userLoading = true\n        clearTimeout(this.timeout)\n        this.timeout = setTimeout(() => {\n          Request.get('/user/search', {\n            params: {\n              username: query,\n              limit: 10\n            }\n          }).then(response => {\n            this.userLoading = false\n            if (response.code === '0') {\n              this.userList = response.data || []\n            }\n          }).catch(() => {\n            this.userLoading = false\n          })\n        }, 300)\n      } else {\n        this.userList = []\n      }\n    },\n\n    handleSendTypeChange() {\n      this.notificationForm.userId = null\n      this.notificationForm.role = null\n      this.userList = []\n    }\n  }\n}\n</script>\n\n<style lang=\"less\">\n.notification-wrapper {\n  .el-card {\n    min-height: 656px;\n  }\n\n  .control-btns {\n    margin-bottom: 20px;\n  }\n\n  .search-form {\n    padding: 10px !important;\n    background-color: #f7f8fb;\n    margin-bottom: 20px;\n  }\n\n  .el-table {\n    margin-top: 20px;\n  }\n}\n</style> ","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PetNotificationManagement.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PetNotificationManagement.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./PetNotificationManagement.vue?vue&type=template&id=5986fabe\"\nimport script from \"./PetNotificationManagement.vue?vue&type=script&lang=js\"\nexport * from \"./PetNotificationManagement.vue?vue&type=script&lang=js\"\nimport style0 from \"./PetNotificationManagement.vue?vue&type=style&index=0&id=5986fabe&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","handleSendNotification","_v","batchDelete","ref","listQuery","model","value","username","callback","$$v","$set","expression","status","onSubmit","onReset","directives","name","rawName","listLoading","staticStyle","tableData","handleSelectionChange","scopedSlots","_u","key","fn","scope","row","_s","$event","markAsRead","_e","handleDelete","total","currentPage","size","fetchData","dialogVisible","notificationForm","rules","handleSendTypeChange","sendType","role","remoteSearchUsers","userLoading","userId","_l","userList","user","id","email","message","slot","submitNotification","staticRenderFns","components","Pagination","data","multipleSelection","userQuery","timeout","required","trigger","mounted","methods","formatDateTime","timestamp","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","Request","get","params","then","response","code","records","map","item","catch","$refs","validate","valid","url","post","$message","success","error","val","put","$confirm","confirmButtonText","cancelButtonText","type","delete","length","join","warning","query","clearTimeout","setTimeout","limit","component"],"sourceRoot":""}